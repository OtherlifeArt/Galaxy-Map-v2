<!DOCTYPE html>
<html>
<head>
	<title>Leaflet Map with Grid</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
	<style>
		#map { height: 600px; }
	</style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>

	var map = L.map('map', {
		crs: L.CRS.Simple,
		minZoom: -3,
		maxZoom: 8
	});

	var bounds = [[-900, 1100], [1200, -1400]];
	map.fitBounds(bounds);

	L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
	}).addTo(map);

	// Define grid options
	var gridOptions = {
		weight: 1,
		color: '#000',
		opacity: 0.5,
	};

	// Add grid for squares of 100 meters (zoom -3 to -8)
	var grid100m = [];
	for (var i = -900; i <= 1200; i += 100) {
		for (var j = 1100; j >= -1400; j -= 100) {
			grid100m.push(
				L.rectangle(
					[[i, j], [i + 100, j - 100]],
					gridOptions
				)
			);
		}
	}

	// Add grid for squares of 10 meters (zoom 1 to 8)
	var grid10m = [];
	for (var i = -900; i <= 1200; i += 10) {
		for (var j = 1100; j >= -1400; j -= 10) {
			grid10m.push(
				L.rectangle(
					[[i, j], [i + 10, j - 10]],
					gridOptions
				)
			);
		}
	}

	// Add grid for squares of 1 meter (zoom 5 to 8)
	var grid1m = [];
	for (var i = -900; i <= 1200; i += 1) {
		for (var j = 1100; j >= -1400; j -= 1) {
			grid1m.push(
				L.rectangle(
					[[i, j], [i + 1, j - 1]],
					gridOptions
				)
			);
		}
	}

	// Add grid layers to the map
	var allGrids = {
		grid100m: L.layerGroup(grid100m).addTo(map),
		grid10m: L.layerGroup(grid10m),
		grid1m: L.layerGroup(grid1m)
	};

	map.on('zoomend', function() {
		var zoomLevel = map.getZoom();

		// Hide or show grid layers based on zoom level
		if (zoomLevel >= -3 && zoomLevel <= -8) {
			allGrids.grid10m.remove();
			allGrids.grid1m.remove();
		} else if (zoomLevel >= 1 && zoomLevel <= 8) {
			allGrids.grid10m.addTo(map);
			allGrids.grid1m.remove();
		} else if (zoomLevel >= 5 && zoomLevel <= 8) {
			allGrids.grid10m.remove();
			allGrids.grid1m.addTo(map);
		} else {
			allGrids.grid10m.remove();
			allGrids.grid1m.remove();
		}
	});

</script>

</body>
</html>
